<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>ESCR Chatbot</title>

    <link rel="stylesheet" href="css/navbar.css">
    <link rel="stylesheet" href="css/chatbot.css">
</head>
<div id="notifPanel" class="notif-panel">
    <h3>Notifications</h3>
    <div id="notifList"></div>
</div>
<body>

    <!-- TOP NAVBAR -->
    <header class="topbar modern">
        <div class="topbar-left">
            <button class="menu-btn" onclick="toggleSidebar()">â˜°</button>
            <img src="images/school-logo.jpg" class="logo">
            <div class="title">
                <strong class="school-text">East Systems Colleges of Rizal</strong>
                <br>
                <span class="portal-text">Student Portal</span>
            </div>
        </div>

        <div class="topbar-right">
            <div class="notif-bell" onclick="openNotifications()">
                ğŸ”” <span id="notifCount" class="notif-count">0</span>
            </div>
            <div class="profile">
                <div class="avatar"></div>
                <div class="profile-text">
                    <strong class="student-name"></strong>
                    <span class="student-role"></span>
                </div>
            </div>
        </div>
    </header>

    <!-- SIDEBAR -->
    <aside class="sidebar modern" id="sidebar">
        <a href="dashboard.html">ğŸ  Dashboard</a>
        <a href="chatbot.html" class="active">ğŸ¤– ESCR Chatbot</a>
        <a href="class-schedule.html">ğŸ“… Class Schedule</a>
        <a href="school-calendar.html">ğŸ—“ School Calendar</a>
        <a href="settings.html">âš™ï¸ Settings</a>
        <a href="login.html" class="logout">ğŸšª Logout</a>
    </aside>

    <!-- MAIN CONTENT -->
    <div class="main-content">

        <div class="chat-red">
            <div class="chat-container">

                <div class="chat-box" id="chatBox"></div>

                <div class="chat-actions">

                    <div class="feedback-bar">
                        <button id="giveFeedbackBtn">Give Feedback</button>
                    </div>

                    <div class="quick-actions" id="categoryActions"></div>

                </div>

                <div class="chat-input">
                    <input
                        type="text"
                        id="userMessage"
                        placeholder="Type your message..."
                    >
                    <button onclick="sendMessage()">Send</button>
                </div>

            </div>
        </div>

    </div>
<div class="modal-overlay" id="feedbackModal">
    <div class="modal-box">
        <h3>Was this conversation helpful?</h3>

        <div class="thumb-options">
            <button onclick="submitFeedback('yes')" class="thumb-btn">ğŸ‘</button>
            <button onclick="submitFeedback('no')" class="thumb-btn">ğŸ‘</button>
        </div>

        <div class="modal-actions">
            <button onclick="closeFeedbackModal()" class="btn-cancel">
                Cancel
            </button>
        </div>
    </div>
</div>
<!-- GLOBAL TOAST -->
<div id="toast-container"></div>
<script src="toast.js"></script>
<script src="script.js"></script>

<script>
    function toggleSidebar() {
        document.getElementById("sidebar").classList.toggle("show");
    }

    document.addEventListener("DOMContentLoaded", () => {
        requireLogin();

        sessionStorage.removeItem("activeCategory");
        isInCategoryFlow = false;

        loadChatbotAdminProfile();   

        loadCategories();
        loadChatHistory();
        setInterval(loadChatHistory, 5000);
    });

    requireLogin();
    loadUserInfo();
    loadProfilePhotoEverywhere();
    loadAvatarEverywhere();
</script>

</body>
</html>
